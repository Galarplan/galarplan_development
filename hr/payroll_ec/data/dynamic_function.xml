<?xml version="1.0" ?>
<odoo>
<data noupdate="0">


    <record model='dynamic.function' id='fx_compute_days'>
			<field name='name'>compute_days</field>
			<field name='arguments'>date_from,date_to,top_days</field>
			<field name='active' eval="True" />
			<field name='programming_code'>result=(date_to-date_from).days
result=result+1
if top_days>0:
    if result>=top_days:
        result=top_days
result=result,top_days</field>
		</record>

	<record model='dynamic.function' id='fx_compute_worked_days'>
			<field name='name'>compute_worked_days</field>
			<field name='arguments'>date_from,date_to</field>
			<field name='active' eval="True" />
			<field name='programming_code'>dtObj=datem()
TOP_DAYS=30
dtCal=calendarm()
LAST_DAY=dtCal.days(date_to.year,date_to.month)
DAY=LAST_DAY
month_flag_days=0
if(LAST_DAY>TOP_DAYS):
    DAY=TOP_DAYS
    month_flag_days=0
if(LAST_DAY&lt;TOP_DAYS):
    DAY=TOP_DAYS
    month_flag_days=(TOP_DAYS-LAST_DAY)
result=(date_to-date_from).days
result=result+month_flag_days+1
if result>=TOP_DAYS:
  result=TOP_DAYS
result=result</field>
		</record>

 <record model='dynamic.function' id='fx_compute_quincena'>
			<field name='name'>compute_quincena</field>
			<field name='arguments'>brw_contract,date_process</field>
			<field name='active' eval="True" />
			<field name='programming_code'>DAY=15
DEC=2
total=0.00
if brw_contract is not None and brw_contract:
    days,top_days=compute_days(brw_contract.date_start,datem().create(date_process.year,date_process.month,DAY).date(),DAY)
    amount=brw_contract.value or 0.00
    if brw_contract.first_fitten_payment_mode=='percent':
        amount=brw_contract.wage*float(brw_contract.value/100.00)
    total=round((amount/15.00)*float(days),DEC)
result={"total":total}</field>
		</record>

	<record model='dynamic.function' id='fx_compute_wages'>
			<field name='name'>compute_salario</field>
			<field name='arguments'>brw_payslip</field>
			<field name='active' eval="True" />
			<field name='programming_code'>DEC = 2
total_days = sum(line.number_of_days for line in brw_payslip.worked_days_line_ids)# if line.is_worked_days
result = round(((brw_payslip.wage / 30.00) * total_days), DEC)</field>
		</record>

	<record model='dynamic.function' id='fx_compute_other_incomes_iess'>
			<field name='name'>compute_otros_ingresos_iess</field>
			<field name='arguments'>brw_payslip</field>
			<field name='active' eval="True" />
			<field name='programming_code'>DEC = 2
other_incomes_iess = sum(input.amount  for input in brw_payslip.input_line_ids if input.add_iess and input.rule_id.category_id.code=='IN')
result = round(other_incomes_iess, DEC)</field>
		</record>

	<record model='dynamic.function' id='fx_compute_dec14'>
			<field name='name'>compute_dec_14</field>
			<field name='arguments'>brw_payslip,payment</field>
			<field name='active' eval="True" />
			<field name='programming_code'>amount=0.00
DEC=2
if brw_payslip.contract_id.pay_fourteenth_salary==payment:
    legal_basic_wages=brw_payslip.legal_basic_wages
    amount=round(((legal_basic_wages/30.00)*brw_payslip.total_worked_days)/12.00,DEC)
result=amount</field>
		</record>

	<record model='dynamic.function' id='fx_compute_dec13'>
			<field name='name'>compute_dec_13</field>
			<field name='arguments'>brw_payslip,payment</field>
			<field name='active' eval="True" />
			<field name='programming_code'>amount=0.00
DEC=2
if brw_payslip.contract_id.pay_thirteenth_salary==payment:
    total_income_iess=compute_salario(brw_payslip)+compute_otros_ingresos_iess(brw_payslip)
    amount=round(total_income_iess/12.00,DEC)
result=amount</field>
		</record>

	<record model='dynamic.function' id='fx_compute_iess'>
			<field name='name'>compute_iess</field>
			<field name='arguments'>brw_payslip,factor</field>
			<field name='active' eval="True" />
			<field name='programming_code'>DEC=2
total_income_iess=compute_salario(brw_payslip)+compute_otros_ingresos_iess(brw_payslip)
amount=round(total_income_iess*factor/100.00,DEC)
result=amount</field>
		</record>

<record model='dynamic.function' id='fx_compute_ext_conyugue'>
			<field name='name'>compute_ext_conyugue</field>
			<field name='arguments'>brw_payslip,payment</field>
			<field name='active' eval="True" />
			<field name='programming_code'>amount=0.00
DEC=2
if brw_payslip.contract_id.add_iees==payment:
    total_income_iess=compute_salario(brw_payslip)+compute_otros_ingresos_iess(brw_payslip)
    amount=round(total_income_iess*3.41/100.00,DEC)
result=amount</field>
		</record>



	<record model='dynamic.function' id='fx_compute_fondo_reserva'>
			<field name='name'>compute_fondo_reserva</field>
			<field name='arguments'>brw_payslip,payment</field>
			<field name='active' eval="True" />
			<field name='programming_code'>DEC=2
TOP_DAYS=30
factor=0.00
amount=0.00
if brw_payslip.contract_id.pay_reserve_funds==payment:#valor actual en contrato de pago o provision
    DATE_TO=datem().create(brw_payslip.date_to.year,brw_payslip.date_to.month,brw_payslip.contract_id.date_start.day).date()
    days=brw_payslip.employee_id.previous_day_contract#dias previos al sistema
    days+=brw_payslip.contract_id.get_days_contracts_end(brw_payslip.contract_id.employee_id.id)#contractos_finalizados
    days+=brw_payslip.contract_id.get_current_contract_days(date_to=DATE_TO)#dias desde el inicio del contrato al mes actual mismo dia
    if days>=365:
        factor=1.00
        if days>=365 and days&lt;=395:#esta dentro del rango del mes recien cumplido al tope
            MONTH_DAYS=TOP_DAYS-compute_days(brw_payslip.date_from,DATE_TO,TOP_DAYS)[0]#deberia dar el residual del resto del mes
            factor=MONTH_DAYS/TOP_DAYS
        amount=round(compute_iess(brw_payslip,8.33)*factor,DEC)
result=amount</field>
		</record>



</data>

</odoo>